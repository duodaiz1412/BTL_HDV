{"ast":null,"code":"import axios from 'axios';\nconst API_URL = 'http://localhost:8000';\nconst NOTIFICATION_SOCKET_URL = 'http://localhost:8000';\nconst api = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nconst handleError = error => {\n  if (error.response) {\n    // Lỗi từ server với status code\n    throw new Error(error.response.data.message || 'Có lỗi xảy ra từ server');\n  } else if (error.request) {\n    // Lỗi không nhận được response\n    throw new Error('Không thể kết nối đến server');\n  } else {\n    // Lỗi khác\n    throw new Error('Có lỗi xảy ra');\n  }\n};\n\n// Auth APIs\nexport const login = async credentials => {\n  try {\n    const response = await api.post('/auth/login', credentials);\n    return response;\n  } catch (error) {\n    throw error;\n  }\n};\nexport const register = async userData => {\n  try {\n    const response = await api.post('/auth/register', userData);\n    return response;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Movie APIs\nexport const getMovies = () => api.get('/movies');\nexport const getMovieById = id => api.get(`/movies/${id}`);\nexport const getShowtimes = movieId => api.get(`/movies/${movieId}/showtimes`);\n\n// Booking APIs\nexport const createBooking = async bookingData => {\n  try {\n    // Endpoint: POST /bookings\n    // Request body: \n    // {\n    //   \"customer_id\": \"string\",\n    //   \"movie_id\": \"string\",\n    //   \"showtime_id\": \"string\",\n    //   \"showtime\": \"string\",\n    //   \"seats\": [{ \"seat_id\": \"string\", \"seat_number\": \"string\" }],\n    //   \"total_amount\": 0,\n    //   \"status\": \"pending\"\n    // }\n    const response = await api.post('/bookings', bookingData);\n    return response;\n  } catch (error) {\n    console.error('Error creating booking:', error);\n    throw error;\n  }\n};\nexport const getBookings = () => {\n  const customerId = localStorage.getItem('customer_id');\n  if (!customerId) {\n    throw new Error('Customer ID not found');\n  }\n  return api.get(`/bookings/customer/${customerId}`);\n};\nexport const getBookingById = id => api.get(`/bookings/${id}`);\n\n// Payment APIs\nexport const createPayment = paymentData => api.post('/payments', paymentData);\nexport const getPayments = () => api.get('/payments');\nexport const getPaymentById = id => api.get(`/payments/${id}`);\n\n// Seat APIs\nexport const getSeats = showtimeId => api.get(`/seats/showtime/${showtimeId}`);\nexport const checkSeats = (showtimeId, seatIds) => api.post(`/seats/check`, seatIds, {\n  params: {\n    showtime_id: showtimeId\n  }\n});\nexport const bookSeats = (customer_id, movie_id, showtime_id, showtime, seats, total_amount, status) => {\n  // Chuyển đổi mảng seat_id thành mảng đối tượng {seat_id, seat_number}\n  const formattedSeats = Array.isArray(seats) ? seats.map(seatId => {\n    // Nếu seats đã là mảng đối tượng thì không cần chuyển đổi\n    if (typeof seatId === 'object' && seatId.seat_id && seatId.seat_number) {\n      return seatId;\n    }\n    // Nếu không tìm thấy thông tin về seat_number, trả về một giá trị mặc định\n    return {\n      seat_id: seatId,\n      seat_number: seatId\n    };\n  }) : [];\n  return api.post('/bookings', {\n    customer_id,\n    movie_id,\n    showtime_id,\n    showtime,\n    seats: formattedSeats,\n    total_amount,\n    status\n  });\n};\n\n// Customer APIs\nexport const getProfile = () => {\n  const customerId = localStorage.getItem('customer_id');\n  if (!customerId) {\n    throw new Error('Customer ID not found');\n  }\n  return api.get(`/customers/${customerId}`);\n};\nexport const updateProfile = data => {\n  const customerId = localStorage.getItem('customer_id');\n  if (!customerId) {\n    throw new Error('Customer ID not found');\n  }\n  return api.put(`/customers/${customerId}`, data);\n};\n\n// Notification APIs\nexport const getNotifications = () => {\n  const customerId = localStorage.getItem('customer_id');\n  if (!customerId) {\n    throw new Error('Customer ID not found');\n  }\n  return api.get(`/notifications/customer/${customerId}`);\n};\nexport const markNotificationAsRead = notificationId => {\n  return api.put(`/notifications/${notificationId}/status`, null, {\n    params: {\n      status: 'read'\n    }\n  });\n};\n\n// Lấy thống kê booking của khách hàng\nexport const getCustomerBookingStats = async customerId => {\n  try {\n    const response = await axios.get(`${API_URL}/bookings/customer/${customerId}`);\n    return response.data;\n  } catch (error) {\n    throw handleError(error);\n  }\n};\nexport default api;","map":{"version":3,"names":["axios","API_URL","NOTIFICATION_SOCKET_URL","api","create","baseURL","headers","handleError","error","response","Error","data","message","request","login","credentials","post","register","userData","getMovies","get","getMovieById","id","getShowtimes","movieId","createBooking","bookingData","console","getBookings","customerId","localStorage","getItem","getBookingById","createPayment","paymentData","getPayments","getPaymentById","getSeats","showtimeId","checkSeats","seatIds","params","showtime_id","bookSeats","customer_id","movie_id","showtime","seats","total_amount","status","formattedSeats","Array","isArray","map","seatId","seat_id","seat_number","getProfile","updateProfile","put","getNotifications","markNotificationAsRead","notificationId","getCustomerBookingStats"],"sources":["D:/BTL_HDV/mid-project-379283427/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:8000';\r\nconst NOTIFICATION_SOCKET_URL = 'http://localhost:8000';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\nconst handleError = (error) => {\r\n  if (error.response) {\r\n    // Lỗi từ server với status code\r\n    throw new Error(error.response.data.message || 'Có lỗi xảy ra từ server');\r\n  } else if (error.request) {\r\n    // Lỗi không nhận được response\r\n    throw new Error('Không thể kết nối đến server');\r\n  } else {\r\n    // Lỗi khác\r\n    throw new Error('Có lỗi xảy ra');\r\n  }\r\n};\r\n\r\n// Auth APIs\r\nexport const login = async (credentials) => {\r\n  try {\r\n    const response = await api.post('/auth/login', credentials);\r\n    return response;\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const register = async (userData) => {\r\n  try {\r\n    const response = await api.post('/auth/register', userData);\r\n    return response;\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Movie APIs\r\nexport const getMovies = () => api.get('/movies');\r\nexport const getMovieById = (id) => api.get(`/movies/${id}`);\r\nexport const getShowtimes = (movieId) => api.get(`/movies/${movieId}/showtimes`);\r\n\r\n// Booking APIs\r\nexport const createBooking = async (bookingData) => {\r\n  try {\r\n    // Endpoint: POST /bookings\r\n    // Request body: \r\n    // {\r\n    //   \"customer_id\": \"string\",\r\n    //   \"movie_id\": \"string\",\r\n    //   \"showtime_id\": \"string\",\r\n    //   \"showtime\": \"string\",\r\n    //   \"seats\": [{ \"seat_id\": \"string\", \"seat_number\": \"string\" }],\r\n    //   \"total_amount\": 0,\r\n    //   \"status\": \"pending\"\r\n    // }\r\n    const response = await api.post('/bookings', bookingData);\r\n    return response;\r\n  } catch (error) {\r\n    console.error('Error creating booking:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getBookings = () => {\r\n  const customerId = localStorage.getItem('customer_id');\r\n  if (!customerId) {\r\n    throw new Error('Customer ID not found');\r\n  }\r\n  return api.get(`/bookings/customer/${customerId}`);\r\n};\r\n\r\nexport const getBookingById = (id) => api.get(`/bookings/${id}`);\r\n\r\n// Payment APIs\r\nexport const createPayment = (paymentData) => api.post('/payments', paymentData);\r\nexport const getPayments = () => api.get('/payments');\r\nexport const getPaymentById = (id) => api.get(`/payments/${id}`);\r\n\r\n// Seat APIs\r\nexport const getSeats = (showtimeId) => api.get(`/seats/showtime/${showtimeId}`);\r\nexport const checkSeats = (showtimeId, seatIds) => api.post(`/seats/check`, seatIds, {\r\n  params: { showtime_id: showtimeId }\r\n});\r\nexport const bookSeats = (customer_id, movie_id, showtime_id, showtime, seats, total_amount, status) => {\r\n  // Chuyển đổi mảng seat_id thành mảng đối tượng {seat_id, seat_number}\r\n  const formattedSeats = Array.isArray(seats) ? seats.map(seatId => {\r\n    // Nếu seats đã là mảng đối tượng thì không cần chuyển đổi\r\n    if (typeof seatId === 'object' && seatId.seat_id && seatId.seat_number) {\r\n      return seatId;\r\n    }\r\n    // Nếu không tìm thấy thông tin về seat_number, trả về một giá trị mặc định\r\n    return { seat_id: seatId, seat_number: seatId };\r\n  }) : [];\r\n\r\n  return api.post('/bookings', { \r\n    customer_id, \r\n    movie_id, \r\n    showtime_id, \r\n    showtime, \r\n    seats: formattedSeats, \r\n    total_amount, \r\n    status \r\n  });\r\n};\r\n\r\n// Customer APIs\r\nexport const getProfile = () => {\r\n  const customerId = localStorage.getItem('customer_id');\r\n  if (!customerId) {\r\n    throw new Error('Customer ID not found');\r\n  }\r\n  return api.get(`/customers/${customerId}`);\r\n};\r\n\r\nexport const updateProfile = (data) => {\r\n  const customerId = localStorage.getItem('customer_id');\r\n  if (!customerId) {\r\n    throw new Error('Customer ID not found');\r\n  }\r\n  return api.put(`/customers/${customerId}`, data);\r\n};\r\n\r\n// Notification APIs\r\nexport const getNotifications = () => {\r\n  const customerId = localStorage.getItem('customer_id');\r\n  if (!customerId) {\r\n    throw new Error('Customer ID not found');\r\n  }\r\n  return api.get(`/notifications/customer/${customerId}`);\r\n};\r\n\r\nexport const markNotificationAsRead = (notificationId) => {\r\n  return api.put(`/notifications/${notificationId}/status`, null, {\r\n    params: { status: 'read' }\r\n  });\r\n};\r\n\r\n// Lấy thống kê booking của khách hàng\r\nexport const getCustomerBookingStats = async (customerId) => {\r\n  try {\r\n    const response = await axios.get(`${API_URL}/bookings/customer/${customerId}`);\r\n    return response.data;\r\n  } catch (error) {\r\n    throw handleError(error);\r\n  }\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}